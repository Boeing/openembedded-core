From 97016d8de27584df3baa327509a53b767c3b79f3 Mon Sep 17 00:00:00 2001
From: Nick Wellnhofer <wellnhofer@aevum.de>
Date: Mon, 12 May 2025 17:11:31 +0200
Subject: [PATCH 2/5] Fix element check

Signed-off-by: Nick Wellnhofer <wellnhofer@aevum.de>

Upstream-Status: Submitted [https://github.com/itstool/itstool/pull/57/commits/30289d5b532bb888f2e6099c04976e441141dd01]
Cherry pick from upstream and and rebase to 2.0.7
Signed-off-by: Hongxu Jia <hongxu.jia@windriver.com>
---
 itstool.in | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/itstool.in b/itstool.in
index 4c73154..4f1f44f 100755
--- a/itstool.in
+++ b/itstool.in
@@ -864,7 +864,6 @@ class Document (object):
                             newnode.tail = prevtext
                     i += 1
 
-
     def merge_translations(self, translations, language, node=None, strict=False):
         is_root = False
         if node is None:
@@ -1026,7 +1025,8 @@ class Document (object):
         if isinstance(node, etree._Entity):
             msg.add_entity_ref(node.name)
             return
-        if isinstance(node, XMLAttr):
+        # Only allow elements
+        if isinstance(node, XMLAttr) or not isinstance(node.tag, str):
             return
         if node.get('{' + NS_ITST + '}drop', 'no') == 'yes':
             return
-- 
2.34.1

